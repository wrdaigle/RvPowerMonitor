(this.webpackJsonpRvPowerMonitor=this.webpackJsonpRvPowerMonitor||[]).push([[0],{209:function(e,t,a){},395:function(e,t,a){},407:function(e,t,a){"use strict";a.r(t);var r=a(5),n=a(1),c=a.n(n),i=a(63),o=a.n(i),s=(a(209),a(23)),l=a(70),j=Object(n.createContext)(),d={powerData:null,chartMetric:"watts",chartTimeSpan:6,fetching:!1},b="localhost"===window.location.hostname?"http://192.168.4.37":"",u=function(e,t){switch(t.type){case"SET_FETCHING":return Object(s.a)(Object(s.a)({},e),{},{fetching:!0});case"SET_POWER_DATA":return Object(s.a)(Object(s.a)({},e),{},{powerData:t.to,fetching:!1});case"SET_CHART_METRIC":return Object(s.a)(Object(s.a)({},e),{},{chartMetric:t.to});case"SET_CHART_TIME_SPAN":return Object(s.a)(Object(s.a)({},e),{},{chartTimeSpan:parseInt(t.to,10)});default:throw new Error}},h=function(e){var t=Object(n.useReducer)(u,d),a=Object(l.a)(t,2),c=a[0],i=a[1];Object(n.useEffect)((function(){c.powerData||o()}),[]),Object(n.useEffect)((function(){o();var e=setInterval((function(){c.fetching||o()}),1e4);return function(){return clearInterval(e)}}),[c.chartTimeSpan]);var o=function(){i({type:"SET_FETCHING"}),fetch(b+"/api/hours/"+c.chartTimeSpan.toString()).then((function(e){return e.json()})).then((function(e){i({type:"SET_POWER_DATA",to:e})}))};return Object(r.jsx)(j.Provider,{value:{powerData:c.powerData,setPowerData:o,chartMetric:c.chartMetric,setChartMetric:function(e){i({type:"SET_CHART_METRIC",to:e})},chartTimeSpan:c.chartTimeSpan,setChartTimeSpan:function(e){i({type:"SET_CHART_TIME_SPAN",to:e})},fetching:c.fetching},children:e.children})},f=a(418),O=a(179),x=a(178),g=a(422),p=a(421),w=a(423),m=a(424),v=a(417);var y=function(e){var t=e.isPortrait,a=Object(n.useContext)(j).powerData;if(!a)return null;var c=100*a.latestData.amphours/a.batteryCapacity,i=a.latestData.watts/a.latestData.voltage,o=t?["1/2","1/2"]:["auto"],s=t?["1/2","1/2"]:["1/4","1/4","1/4","1/4"];return Object(r.jsxs)(g.a,{fill:!0,columns:s,rows:o,pad:"medium",children:[Object(r.jsxs)(p.a,{align:"center",justify:"center",direction:"row",children:[Object(r.jsx)(w.a,{size:"xxlarge",weight:"bold",color:"accent-1",children:Math.round(10*a.latestData.watts)/10}),Object(r.jsx)(w.a,{children:"\xa0watts"})]}),Object(r.jsxs)(p.a,{align:"center",justify:"center",direction:"row",children:[Object(r.jsx)(w.a,{size:"xxlarge",weight:"bold",color:"accent-1",children:Math.round(100*i)/100}),Object(r.jsx)(w.a,{children:"\xa0amps"})]}),Object(r.jsxs)(p.a,{align:"center",justify:"center",direction:"row",children:[Object(r.jsx)(w.a,{size:"xxlarge",weight:"bold",color:"accent-1",children:Math.round(10*a.latestData.voltage)/10}),Object(r.jsx)(w.a,{children:"\xa0volts"})]}),Object(r.jsx)(p.a,{children:Object(r.jsxs)(m.a,{fill:!0,anchor:"center",children:[Object(r.jsx)(p.a,{fill:!0,align:"center",children:Object(r.jsx)(v.a,{size:"small",type:"circle",background:"dark-2",values:[{value:c,color:"accent-1"}]})}),Object(r.jsxs)(p.a,{align:"center",direction:"row",children:[Object(r.jsx)(w.a,{size:"xxlarge",weight:"bold",children:Math.round(c,0)}),Object(r.jsx)(w.a,{children:"%"})]})]})})]})},T=a(17),k=a(177),S=a.n(k);var C=function(){var e=Object(n.useContext)(j),t=e.powerData,a=e.chartMetric,c=e.chartTimeSpan;return t?Object(r.jsx)(p.a,{fill:!0,children:Object(r.jsx)(T.e,{children:Object(r.jsxs)(T.c,{data:t.graphData,margin:{top:5,right:30,left:20,bottom:5},children:[Object(r.jsx)(T.b,{stroke:"rgba(120,120,120,0.2)"}),Object(r.jsx)(T.f,{dataKey:"time",scale:"time",type:"number",domain:["auto","auto"],allowDataOverflow:!0,tickFormatter:function(e){return S()(e).format(c<48?"LT":"MM/DD h:mm a")},style:{fontSize:"10px",fill:"rgb(200,200,200)"}}),Object(r.jsx)(T.g,{width:30,type:"number",domain:"amphours"===a?[.2]:["dataMin","dataMax"],style:{fontSize:"10px",fill:"rgb(200,200,200)"},ticks:"amphours"===a?[0,25,50,75,100,125,150,175,200]:null}),"watts"===a&&[Object(r.jsx)(T.d,{type:"linear",dataKey:a,stroke:"#6FFFB0",strokeWidth:2,dot:!1},a),Object(r.jsx)(T.d,{type:"linear",dataKey:"watts_min",stroke:"rgba(111, 255, 176,0.5)",strokeDasharray:"5 5",strokeWidth:1,dot:!1},"watts_min"),Object(r.jsx)(T.d,{type:"linear",dataKey:"watts_max",stroke:"rgba(111, 255, 176,0.5)",strokeDasharray:"5 5",strokeWidth:1,dot:!1},"watts_max")],"voltage"===a&&Object(r.jsx)(T.d,{type:"linear",dataKey:a,stroke:"#ff6fe7",strokeWidth:2,dot:!1},a),"amphours"===a&&Object(r.jsx)(T.a,{type:"linear",dataKey:a,stroke:"#6fafff"},a)]})})}):null},M=a(425),E=a(419);var D=function(){var e=Object(n.useContext)(j),t=e.chartMetric,a=e.setChartMetric,c=["watts","voltage","amphours"];return Object(r.jsxs)(M.a,{flex:!0,activeIndex:c.indexOf(t),onActive:function(e){return a(c[e])},alignControls:"center",children:[Object(r.jsx)(E.a,{title:"Watts",children:Object(r.jsx)(C,{})}),Object(r.jsx)(E.a,{title:"Volts",children:Object(r.jsx)(C,{})}),Object(r.jsx)(E.a,{title:"Battery Capacity",children:Object(r.jsx)(C,{})})]})},_=a(420);var I=function(){var e=Object(n.useContext)(j),t=e.chartTimeSpan,a=e.setChartTimeSpan,c=e.fetching;return Object(r.jsx)(p.a,{align:"end",children:Object(r.jsx)(_.a,{name:"radio",direction:"row",gap:"small",pad:{right:"medium"},options:[{disabled:c,value:2,label:"2 hours"},{disabled:c,value:6,label:"6 hours"},{disabled:c,value:24,label:"1 day"},{disabled:c,value:72,label:"3 days"},{disabled:c,value:168,label:"1 week"},{disabled:c,value:672,label:"4 weeks"}],value:t,onChange:function(e){a(e.target.value)},children:function(e,t){var a,n=t.checked,i=t.hover;return a=n?"accent-1":i&&!c?"dark-4":"dark-2",Object(r.jsx)(p.a,{background:a,pad:"xsmall",children:Object(r.jsxs)(w.a,{size:"xsmall",children:[" ",e.label]})})}})})};var P=function(){var e=Object(n.useState)(window.innerHeight>window.innerWidth),t=Object(l.a)(e,2),a=t[0],c=t[1],i=function(){c(window.innerHeight>window.innerWidth)};Object(n.useEffect)((function(){return window.addEventListener("resize",i),function(){return window.removeEventListener("resize",i)}}),[]);var o=a?"3fr":"6fr";return console.debug(o),Object(r.jsx)(p.a,{fill:!0,background:"dark-1",children:Object(r.jsxs)(g.a,{fill:!0,rows:[o,"auto","2fr"],children:[Object(r.jsx)(D,{}),Object(r.jsx)(I,{}),Object(r.jsx)(y,{isPortrait:a}),Object(r.jsx)(r.Fragment,{})]})})},A=(a(395),Object(x.deepMerge)(O.grommet,{global:{focus:{border:{color:"transparent"}}},tab:{color:"rgb(140,140,140)",active:{color:"accent-1"},border:{side:"bottom",color:"rgb(140,140,140)",active:{color:"control"}}}}));var F=function(){return Object(r.jsx)(h,{children:Object(r.jsx)(f.a,{full:!0,theme:A,children:Object(r.jsx)(P,{})})})},R=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,426)).then((function(t){var a=t.getCLS,r=t.getFID,n=t.getFCP,c=t.getLCP,i=t.getTTFB;a(e),r(e),n(e),c(e),i(e)}))};o.a.render(Object(r.jsx)(c.a.StrictMode,{children:Object(r.jsx)(F,{})}),document.getElementById("root")),R()}},[[407,1,2]]]);
//# sourceMappingURL=main.a969d623.chunk.js.map